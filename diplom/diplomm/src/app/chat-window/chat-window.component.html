<div class="chat-window" *ngIf="selectedChat;">
  <!-- Ğ—Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²Ğ¾Ğº Ñ‡Ğ°Ñ‚Ğ° -->
  <div class="chat-header">
    <div class="chat-info">
      <div class="avatar-container">
        <div class="avatar">
          <img [src]="selectedChat.avatar" [alt]="selectedChat.name" />
        </div>
        <div class="online-indicator" [class.online]="selectedChat.isOnline"></div>
      </div>

      <div class="chat-details">
        <h2 class="chat-name">{{ selectedChat.name }}</h2>
        <p class="chat-status" [class.online]="selectedChat.isOnline">
          {{ selectedChat.isOnline ? 'Online' : 'Offline' }}
        </p>
      </div>
    </div>

    <div class="chat-actions">
      <button class="action-btn" title="Search in chat">
        ğŸ”
      </button>
      <button class="action-btn" title="More options">
        â‹®
      </button>
    </div>
  </div>

  <div class="messages-container" #messagesContainer>
    <div class="messages">
      <div class="date-divider" *ngIf="messages.length > 0">
        <span>{{ isTodayMessage(messages[0].time) ? 'Today' : 'Yesterday' }}</span>
      </div>

      <!-- Ğ¡Ğ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ -->
      <div *ngFor="let message of messages; let i = index" 
           class="message-wrapper"
           [class.outgoing]="message.isOutgoing"
           [class.with-avatar]="!message.isOutgoing && shouldShowAvatar(i)"
           [class.active]="isMessageActive(message.id || '')"
           [class.deleting]="getMessageClass(message.id || '') === 'deleting'"
           (click)="onMessageClick(message.id || '', $event)">
        
        <div class="message-avatar" *ngIf="!message.isOutgoing && shouldShowAvatar(i)">
          <img [src]="selectedChat.avatar" [alt]="selectedChat.name" />
        </div>

        <div class="avatar-placeholder" *ngIf="message.isOutgoing"></div>

        <div class="message" [class.with-avatar]="!message.isOutgoing && shouldShowAvatar(i)">
          <div class="sender-name" *ngIf="!message.isOutgoing && message.senderName && shouldShowAvatar(i)">
            {{ message.senderName }}
          </div>

          <div class="message-bubble">
            <p class="message-text">{{ message.text }}</p>
            <div class="message-footer">
              <span class="message-time">{{ getMessageTime(message.time) }}</span>
              
            </div>
            
            <button 
              class="delete-btn" 
              *ngIf="shouldShowDeleteButton(message.id || '')"
              (click)="deleteMessage(message.id || '', $event)"
              title="Delete message"
            >
              ğŸ—‘ï¸
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="message-input-container">
    <div class="input-actions">
      <button class="action-btn" title="Attach file">
        ğŸ“
      </button>
      <button 
        class="action-btn emoji-toggle" 
        title="Emoji"
        (click)="toggleEmojiPanel($event)"
        [class.active]="showEmojiPanel"
      >
        ğŸ˜€
      </button>
    </div>

    <div class="input-wrapper">
      <textarea 
        class="message-input" 
        placeholder="ĞĞ°Ğ¿Ğ¸ÑˆĞ¸Ğ¸Ñ‚Ğµ Ñ‡Ñ‚Ğ¾-Ğ½Ğ¸Ğ±ÑƒĞ´ÑŒ..."
        [(ngModel)]="newMessage"
        (keydown)="onKeyPress($event)"
        rows="1"
        #messageInput
      ></textarea>
    </div>

    <button 
      class="send-btn" 
      (click)="sendMessage()"
      [disabled]="!newMessage.trim()"
    >
      Send
    </button>
  </div>

  <!-- ĞŸĞ°Ğ½ĞµĞ»ÑŒ ÑĞ¼Ğ¾Ğ´Ğ·Ğ¸ -->
  <app-emoji-panel 
    *ngIf="showEmojiPanel"
    (emojiSelected)="onEmojiSelected($event)"
    (panelClosed)="closeEmojiPanel()"
  >
  </app-emoji-panel>
</div>

